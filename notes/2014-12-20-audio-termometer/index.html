<!DOCTYPE html>
<html lang="">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Аудио Термометр</title>
  <meta name="description" content="" />
  <!-- Yandex.Metrika counter -->
<script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();
    for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
 
    ym(91297055, "init", {
         clickmap:true,
         trackLinks:true,
         accurateTrackBounce:true
    });
 </script>
 <noscript><div><img src="https://mc.yandex.ru/watch/91297055" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
 <!-- /Yandex.Metrika counter -->

  <link rel="stylesheet" href="/styles/index.css">
  <link rel="stylesheet" href="/styles/katex.min.css">
</head>

<body>
  <nav>
    <ul>
      <li><a class="internal-link" href="/"><b>Ilya&#39;s digital garden</b></a></li>
      <li><a class="internal-link" href="https://cv.senior-sigan.net/">CV</a></li>
      <li><a class="internal-link" href="/talks">Talks</a></li>
      <li><a class="internal-link" href="/notes">Notes</a></li>
    </ul>
  </nav>

  <div class="wrapper">
    <main>
<article>
  <div>
    <h1>Аудио Термометр</h1>
    <time datetime="2014-12-20">20 Dec 2014</time>
  </div>

  <div id="notes-entry-container">
    <content>
      <p><img src="/assets/audio-termometer/fRyw9kv9jmMfIpEz.jpg" alt="Макетная плата"></p>
<p>Существует как минимум 2 способа подключения периферии к любому смартфону — это блютуз и usb. Дополнительно можно рассматривать wifi, nfc, ик-порт. Сейчас наибольшей популярностью пользуется конечно же блютуз. Этот протокол стандартизирован, он удобный, беспроводной и распространенный, достаточно прост в применении. Так же ведутся работы над LE Bluetoooth с низким энергопотреблением. С usb всё намного хуже, так как не каждый смартфон поддерживает функцию двухсторонней передачи данных, кроме того, если понадобится сделать своё usb-устройство, то придется долго разбираться как его зарегистрировать и прочее.</p>
<p>Иногда не требуется вся мощь технологии блютуз, но тогда что использовать вместо него для подключения к смартфону различной периферии, будь то специальные сенсоры, считыватели кредитных карт, измерители скорости ветра или термометр? Как это ни странно, звучит — <strong>использовать аудиовход</strong>! В нашем распоряжении будет чудесный аналоговый интерфейс, без каких либо протоколов передачи данных. Можно будет отправлять обычный модулированный сигнал. Как ни парадоксально, но это именно то, что нужно для большинства проектов по созданию периферии для смартфонов.</p>
<p><img src="/assets/audio-termometer/MgkWSwcJ7VsSxI4Q.jpg" alt="Image for post"></p>
<p>Не мы первые додумались до такого решения, уже существует несколько проектов на основе аудиовхода — это pressy(просто кнопка), kinsa — термометр, vaavud — измеритель скорости ветра. Кроме того существует библиотека для установления соединения между Arduino и андроидом по типу модема.</p>
<ul>
<li>Передача данных — бинарный протокол</li>
<li>Термометр</li>
<li>Осцилограф</li>
<li>Измерение скорости ветра</li>
<li>Велокомпьютер без gps</li>
<li>Различные сенсоры</li>
</ul>
<p>Мы же в итоге остановились на идее термометра.</p>
<ul>
<li><strong>Простота</strong> — нет накладных расходов на упаковку пакетов данных, передачу данных по среде передачи, восстановление ошибок. Если надо отправить один символ, то нет необходимости отправлять целый пакет в несколько байт, шифровать его и распаковывать.</li>
<li><strong>Энергосбережение</strong> — в отличие от блютуза, не требуется так много энергии для передачи данных, установление и поддержания связи. Хотя с учетом Bluetooth LE, тут конечно можно поспорить.</li>
<li><strong>Plug-and-play</strong> — для пользователя в конечном итоге такие устройства будут очень простыми. Необходимо только подключить периферию и всё. Не надо устанавливать соединение, проводить авторизацию и прочие ритуалы для настройки блютуза или wifi.</li>
<li><strong>Совместимость</strong> — аудиоразъем есть на каждом смартфоне. В отличие от usb-host, который есть только на некоторых устройствах.</li>
<li>Нет никакого, даже самого простого стандартного метода для передачи бинарных данных, поэтому всё придется писать с самого начала самому. Например, сделать обыкновенный модем, для передачи бинарных данных. Придется самим вручную исправлять помехи и восстанавливать данные.</li>
<li>Низкая скорость, так как есть ограничение в 44100Гц частоты дискретизации.</li>
<li>Расхождение технических показателей аудио интерфейса. Амплитуды выходных сигналов на разных устройствах могут отличаться.</li>
</ul>
<p>Тем не мене, если вам понадобилась передача данных, то логичнее использовать блютуз, а если нужен просто аналоговый вход, то лучше аудио интерфейса ничего не найти.</p>
<p>Однако, перед использованием этого интерфейса придётся решить ряд технических проблем.</p>
<p>Первая проблема заключается в том, что большинство смартфонов рассчитаны на то, что к аудио разъёму может подключаться только гарнитура. И вы сможете отправить или получить какой-то сигнал через аудио разъём только если смартфон будет уверен, что к нему подключена гарнитура. Как этого добиться?</p>
<p><img src="/assets/audio-termometer/npIKUHELuaDOb4sJ.jpg" alt="Image for post"></p>
<p>Давайте посмотрим, как устроена телефонная гарнитура. Она состоит из штекера с 4-мя контактами, к двум нижним подключены левый и правый наушник, их сопротивление колеблется от 16 до 40 Ом. К верхнему контакту подключен микрофон, его сопротивление примерно 1.5 кОм, а третий снизу контакт — это заземление. Поэтому, в теории, чтобы смартфон принял наше устройство за гарнитуру, необходимо заменить наушники и микрофон резисторами с эквивалентными сопротивлениями. На практике оказалось, что достаточно заменить микрофон резистором на 1.5 кОм.</p>
<p>Следующий вопрос заключается в том, как модифицировать эту схему, чтобы она приносила какую-то пользу.</p>
<p>Самый простой вариант — это добавить в схему ключ параллельно резистору, который будет замыкать микрофон на землю. Смартфон распознаёт это действие как нажатие кнопки гарнитуры. Программа, запущенная на смартфоне может перехватить это событие и каким-то образом его интерпретировать. Например, универсальная кнопка Pressy работает по такому же принципу. Конечно, это довольно примитивный инструмент, который подойдёт только для самых простых устройств.</p>
<p><img src="/assets/audio-termometer/0ODG6g6m1ytQTx2B.jpg" alt="Image for post"></p>
<p>Следующая схема значительно сложнее в реализации. В этой схеме аудио кабель используется как полнодуплексный канал связи, к которому подключается полноценное цифровое устройство. Телефон принимает данные на вход микрофона и отправляет их через выход наушников. Это универсальная схема, поскольку она позволяет подключить к телефону различные сложные цифровые устройства, однако проектирование такого устройства связано с большими трудностями, поскольку придётся разработать собственный протокол обмена данными между телефоном и цифровым устройством.</p>
<p>Следующий вариант схемы немного проще. Телефон генерирует звуковой сигнал и отправляет его на выходы гарнитуры. Сигнал проходит через какую-то электрическую схему, некоторым образом изменяется и подаётся на вход микрофона. Телефон принимает изменённый сигнал и каким-то образом его интерпретирует. Такая схема идеальна для проектирования различных аналоговых датчиков, так как в схеме будет присутствовать элемент, изменяющий, например, сопротивление, в зависимости от некоторых условий. Поэтому для проектирования аудиотермометра такая схема подходит лучше всего.</p>
<p>Теперь возникает вопрос, как на основе данной схемы реализовать термометр. Для нашей схемы отлично подойдёт термистор, элемент, меняющий сопротивление в зависимости от температуры. В итоге получаем следующую схему.</p>
<p><img src="/assets/audio-termometer/IiNnVcLYzND6CwvF.jpg" alt="Image for post"></p>
<p>Ко входу микрофона подключен резистор на 1.5 кОм, к левому каналу подключен резистор сопротивлением 10 кОм, к правому каналу подключен термистор. К земле — резистор 220 Ом.</p>
<p>На левый и правый каналы подаётся синусоидальный сигнал частотой 4 кГц, в противофазе. Сигналы, проходя через термистор и резистор, суммируются и направляются на вход микрофона. Соответственно, при температуре в 25 градусов сопротивления на левом и правом каналах будут равны, поэтому при суммировании каналы дадут сигнал с близкой к нулю амплитудой. При повышении температуры сопротивление на одном из каналов будет падать, поэтому амплитуда суммы сигналов будет расти.</p>
<p><img src="/assets/audio-termometer/M7QngZkJyJO52i0U.jpg" alt="Image for post"></p>
<p>Но, к сожалению, не всё так просто. Такое решение обладает целым рядом недостатков. Во-первых, у каждого устройства своя громкость, поэтому при одинаковой температуре разные телефоны могут показать разные значения. Во-вторых, падении температуры ниже 25 градусов амплитуда сигнала на выходе снова будет расти. Ну и, в-третьих, амплитуду сигнала необходимо перевести в градусы Цельсия.</p>
<p>Для того, чтобы свести недостатки к минимуму, система измерения температуры была немного переделана. Теперь программа автоматически подстраивает громкость на каждом канале таким образом, чтобы амплитуда выходного сигнала всегда была нулевая. Температуре же теперь соответствует разница амплитуд на двух каналах. Для автоматической подстройки амплитуд сигналов применяется система обратной связи.</p>
<p><img src="/assets/audio-termometer/qV5h5eUF-L1iym_A.jpg" alt="Image for post"></p>
<p>В начале, как и раньше, мы отправляем сигнал в противофазе с одинаковой амплитудой на левый и правый каналы. После того, как на входе, с некоторой задержкой, появилась сумма этих сигналов, мы анализируем амплитуду суммы и принимаем решение, на каком из каналов необходимо уменьшить или увеличить громкость. После этого на выход отправляются сигналы с изменённой амплитудой, и программа вновь ждёт на вход сумму этих сигналов. Чтобы гарантировать, что амплитуда суммы сигналов изменилась именно за счёт изменений на входе, а не за счёт изменения температуры, на выход отправляется синхроимпульс частотой 6 кГц, и система анализирует амплитуду суммы сигналов только после того, как получит синхроимпульс.</p>
<p>Для того, чтобы не пытаться переводить шумы, помехи, синхроимпульс в температуру, необходимо проверять какой частоты сигнал пришел на вход. Для этого вычисляется спектр входящего сигнала с помощью быстрого Фурье преобразования. Если частота гармоники с наибольшей амплитудой в спектре совпадает с частотой генерируемого сигнала, то мы получили полезную информацию. Иначе — помехи или синхроимпульс. Тогда игнорируем эти данные. Выводим информацию о том, что невозможно определить температуру.</p>
<p>Вывод формулы для значения температуры. Термисторы характеризуются рядом параметров, такими, как максимальный допустимый ток, точность, сопротивление при определённой температуре (как правило, при 25°С). Одним из параметров, характеризующим степень изменения сопротивления в зависимости от температуры является коэффициент температурной чувствительности, обозначаемый B. Этот коэффициент рассчитывается на основе значений сопротивления при двух конкретных значениях температур. Во многих случаях этими температурами выбираются 25°С и 100°С. Коэффициент B измеряется в Кельвинах и вычисляется по следующей формуле: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mfrac><mrow><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msub><mi>T</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><msub><mi>T</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">B = \frac{ln(R_1) - ln(R_2)}{1 / T_1 - 1 / T_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1/</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1/</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> где R1 и R2 - значения сопротивлений при температурах соответственно T1 и T2, выраженных в Кельвинах. Из этой формулы следуют и обратные: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mfrac><mrow><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mi>B</mi></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>T</mi><mn>2</mn></msub></mfrac><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">T_1 = \frac{1}{\frac{ln(R_1) - ln(R_2)}{B} + \frac{1}{T_2})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.797em;vertical-align:-0.9519em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.4387em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0732em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.5375em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0077em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2996em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0077em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2996em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.1389em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2996em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.558em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9519em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>Термисторы обладают высокой степенью нелинейности параметров, и термисторы различных моделей, даже при одинаковых значениях параметра B25/100 могут по разному изменять сопротивление в зависимости от температуры. Поэтому формула может лишь приблизительно оценить температуру.</p>
<p>Производители термистров всегда прилагают таблицы с зависимостями сопротивления от температуры.</p>
<p>Таким образом для определения температуры достаточно знать значение сопротивления термистора и коэффициент B. В нашем случае мы не можем снимать непосредственно значение напряжения с термистора, используя, например, схему делителя напряжения, поэтому необходимо каким-то образом выразить значение сопротивления через амплитуды выходных сигналов на левом и правом каналах. Логично предположить, что отношение <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub></mfrac><mo>=</mo><mfrac><msub><mi>R</mi><mn>1</mn></msub><msub><mi>R</mi><mn>2</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{A_1}{A_2} = \frac{R_1}{R_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3335em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8884em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3335em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8884em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>, где <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> - сопротивление термистора.
Тогда получаем формулу: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mo>∗</mo><msub><mi>A</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><msub><mi>A</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>B</mi><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T = 1 / ((ln(R_2 * A_1/ A_2) - ln(R_1)) / B + 1 / T_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>.
В нашем случае получаем <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>10000</mn><mo>∗</mo><mi>A</mi><mi>l</mi><mi mathvariant="normal">/</mi><mi>A</mi><mi>r</mi><mo stretchy="false">)</mo><mo>−</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>10000</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>4300</mn><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>298</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T = 1 / ((ln(10000 * Al/ Ar) - ln(10000)) / 4300 + 1 / 298)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">10000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord">/</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">10000</span><span class="mclose">))</span><span class="mord">/4300</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/298</span><span class="mclose">)</span></span></span></span></span>, где B = 4300К, T1 = 298К, R1 = 10000 Ом, R2 = 10000 Ом</p>
<p>Как итог наших теоретических исследований, представим андроид-приложение аудиотермометр. Оно определяет температуру с точностью до 1 градуса, немного инертно но в целом дает реальную температуру. Конечно если задаться целью получить строго значение температуры с точностью до сотых долей, то лучше использовать диоды или еще лучше, готовые термометры, которые посылают значение температуры каким-то сигналом и считывать его аудио входом. Тем не менее с научной и практической точки зрения можно с уверенностью утверждать, что можно выделить некоторое множество проектов, которые было бы удобнее всего реализовывать именно через аудио интерфейс на смартфоне. Такие решения будут изящнее и миниатюрнее, удобнее в использовании, чем сторонние платы, подключаемые через блютуз или usb к смартфону. Существующие финансово успешные проекты подтверждают это.</p>
<ol>
<li><a href="http://electronics.stackexchange.com/questions/38417/how-do-volume-control-headphones-work">How do volume control headphones work?</a></li>
<li><a href="http://www.whence.com/minimodem/">Minimodem — general-purpose software audio FSK modem</a></li>
<li><a href="https://www.sparkfun.com/products/retired/10331">Audio Jack Modem for iPhone and Android</a></li>
<li><a href="http://www.fastcolabs.com/3030202/why-the-best-way-into-your-customers-iphone-is-the-headphone-jack">Why The Best Way Into Your Customer’s iPhone Is The Headphone Jack</a></li>
<li><a href="http://habrahabr.ru/post/196374/">Простыми словами о преобразовании Фурье</a></li>
</ol>
<p>Авторы статьи: <a href="https://medium.com/u/23ab90a702cf?source=post_page-----3ce480b9a8d0----------------------">Ilya Siganov</a> и <a href="https://medium.com/u/b4cf221ae11a?source=post_page-----3ce480b9a8d0----------------------">Кирилл Лейфер</a></p>
<p><a href="https://github.com/cat-in-the-dark/AudioThermometer">Исходный код приложения</a></p>
    </content>
  </div>
</article></main>
  </div>
</body>

</html>